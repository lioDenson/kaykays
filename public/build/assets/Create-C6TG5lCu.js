import{r as m,j as e,u as w,H as D,a as v}from"./app-Cm4b0MRZ.js";import{D as E,c as T,d as L,e as M,f as A,g as B,A as k}from"./app-layout-CKTzcKJV.js";import{L as I,I as F}from"./label-CX7AZ_dB.js";import{C as c}from"./custom-input-C8zmYmQE.js";import{C as H}from"./custom-searchbar-Cs4tA4_I.js";import{C as U}from"./custom-submit-button-C9KFqMKP.js";import{C as O}from"./custom-text-area-DMdpB5BL.js";import{S as P,T as $,a as Q,b as S,c as o,d as R,e as q}from"./table-dbX3KzNP.js";import{u as W}from"./useSearch-Kx7zVd0p.js";import{A as z}from"./auth-layout-C4tO_X4t.js";import{s as f}from"./index-vmwrf4-U.js";import"./app-BUjcEukZ.js";import"./createLucideIcon-CDzehuva.js";import"./index-BzTAvke0.js";import"./index-0pHPRr8x.js";import"./input-4zn4-9bI.js";import"./search-Czf_K0T6.js";import"./loader-circle-BG-66UfA.js";import"./loader-CORz_YrV.js";const G=({trigger:t,label:h,items:a,error:l,onChange:d})=>{const[u,x]=m.useState(""),j=i=>{x(i),d(i)};return e.jsxs("div",{className:"grid gap-2",children:[e.jsx(I,{children:h}),e.jsxs(E,{children:[e.jsx(T,{asChild:!0,children:e.jsx("div",{className:"border rounded flex items-center px-4 h-15",children:u?a.find(i=>i.value===u)?.label:t})}),e.jsxs(L,{className:"w-56",children:[e.jsx(M,{children:h}),e.jsx(A,{}),a.map(i=>e.jsx(B,{onClick:()=>j(i.value),className:"cursor-pointer",children:i.label},i.value))]})]}),l&&e.jsx(F,{message:l,className:"mt-1"})]})};function pe({customer:t,customersIds:h}){const a=t!=null,l=w().props.errors,[d,u]=m.useState(""),[x,j]=m.useState(!1),[i,g]=m.useState(!1),[_,C]=m.useState(!1),[r,n]=m.useState({name:t?.user?.name||"",email:t?.user?.email||"",phone:t?.user?.phone||"",bill_cycle:t?.bill_cycle||"",street:t?.street||"",estate:t?.estate||"",house_number:t?.house_number||"",description:t?.description||"",user_id:t?.user_id||0,is_edit:a}),p=W({query:d,routeName:f("users.search"),isSearching:j,filter:h});m.useEffect(()=>{if(!a){if(d===""){n({name:"",email:"",phone:"",bill_cycle:"",street:"",estate:"",house_number:"",description:"",user_id:0,is_edit:a});return}if(p.results.length>0){const s=p.results[0];n(b=>({...b,name:s.name,email:s.email,phone:s.phone,user_id:s.id}))}else n(s=>({...s,name:"",email:"",phone:"",user_id:0}))}},[p.results,d,a]);const y=()=>(g(!0),a?v.put(f("customers.update",t.id),r,{onFinish:()=>{g(!1)}}):v.post(f("customers.store"),r,{onFinish:()=>{g(!1)}})),N=s=>{C(!0),u(s.name),n({...r,user_id:s.id,name:s.name,email:s.email,phone:s.phone})};return e.jsxs(k,{children:[e.jsx(D,{title:a?`Updated ${t.user.name}`:"Create Customer"}),e.jsxs(z,{title:a?`Updated ${t.user.name}`:"Create Customer",description:a?`Fill the form to update ${t.user.name} customer`:"Fill the form to create a new customer",children:[!a&&e.jsx(H,{value:d,searching:x,setQuery:s=>{C(!1),u(s)}}),p.results.length>0&&d!==""&&!_&&e.jsxs(P,{children:[e.jsx("div",{className:"max-h-[25vh]",children:e.jsxs($,{children:[e.jsx(Q,{children:e.jsxs(S,{children:[e.jsx(o,{}),e.jsx(o,{children:"Name"}),e.jsx(o,{children:"Email"}),e.jsx(o,{children:"Phone"})]})}),e.jsx(R,{className:"text-xs",children:p.results.map((s,b)=>e.jsxs(S,{className:"cursor-pointer",onClick:N.bind(null,s),children:[e.jsx(o,{children:b+1}),e.jsx(o,{children:s.name}),e.jsx(o,{children:s.email}),e.jsx(o,{children:s.phone})]},s.id))})]})}),e.jsx(q,{orientation:"vertical"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 space-x-2",children:[e.jsx(c,{id:"name",name:"name",label:"Name",disabled:!a,readOnly:!a,error:l.name||l.user_id||l.i,value:r.name,onChange:s=>n({...r,name:s.target.value})}),e.jsx(c,{id:"email",name:"email",label:"Email",disabled:!0,readOnly:!0,error:l.email,value:r.email})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 space-x-2",children:[e.jsx(c,{id:"phone",name:"phone",label:"Phone",disabled:!a,readOnly:!a,error:l.phone,value:r.phone,onChange:s=>n({...r,phone:s.target.value})}),e.jsx(c,{id:"street",name:"street",label:"Street",error:l.street,value:r.street,onChange:s=>n({...r,street:s.target.value})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 space-x-2",children:[e.jsx(c,{id:"estate",name:"estate",label:"Estate",error:l.estate,value:r.estate,onChange:s=>n({...r,estate:s.target.value})}),e.jsx(c,{id:"house_number",name:"house_number",label:"House Number",error:l.house_number,value:r.house_number,onChange:s=>n({...r,house_number:s.target.value})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 space-x-2",children:[e.jsx(O,{id:"description",name:"description",label:"Description",error:l.description,onChange:s=>n({...r,description:s.target.value}),value:r.description.toString()}),e.jsx("div",{className:"grid gap-2",children:e.jsx(G,{label:"Bill Cycle",error:l.bill_cycle,items:[{label:"Daily",value:"daily"},{label:"Weekly",value:"weekly"},{label:"Monthly",value:"monthly"}],trigger:"Select Bill Cycle",onChange:s=>n({...r,bill_cycle:s})})})]}),e.jsx(U,{onClick:y,isLoading:i,label:a?"Update Customer":"Create Customer"})]})]})}export{pe as default};
